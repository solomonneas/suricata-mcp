alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Win32/Emotet CnC Activity"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:2; within:1; sid:2024001; rev:1; classtype:trojan-activity; reference:url,abuse.ch/emotet;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 22 (msg:"ET SCAN Potential SSH Scan"; flow:to_server; flags:S,12; threshold: type threshold, track by_src, count 5, seconds 120; sid:2024002; rev:1; classtype:attempted-recon;)
drop tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"ET EXPLOIT OpenSSH Overflow Attempt"; flow:established,to_server; content:"|00 00 00|"; depth:3; content:"|04|"; within:1; sid:2024003; rev:2; classtype:attempted-admin; reference:cve,2024-6387;)
alert udp $HOME_NET any -> any 53 (msg:"ET DNS Query for Suspicious TLD"; content:"|01|"; offset:2; depth:1; content:".xyz"; nocase; sid:2024004; rev:1; classtype:bad-unknown;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DISABLED - Old Detection Rule"; content:"test"; sid:2024005; rev:1; classtype:misc-activity;)
pass tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"PASS - Known Good TLS Traffic"; flow:established; content:"|16 03|"; depth:2; sid:2024006; rev:1; classtype:not-suspicious;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Suspicious User-Agent (MSIE 10.0)"; flow:established,to_server; content:"MSIE 10.0"; http_user_agent; sid:2024007; rev:1; classtype:trojan-activity;)
alert dns $HOME_NET any -> any any (msg:"ET DNS Query to Known DGA Domain"; dns_query; content:".biz"; nocase; sid:2024008; rev:1; classtype:bad-unknown;)
